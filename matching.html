<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ãƒ‡ãƒ¼ãƒˆã«è¡Œã£ã¦ã¿ãŸã„ãƒãƒƒãƒãƒ³ã‚°ã‚¢ãƒ—ãƒª</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0f4f8, #d9e2ec);
            color: #334155;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow-x: hidden;
        }
        .container {
            background: linear-gradient(145deg, #ffffff, #f0f4f8);
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 550px;
            width: 95%;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        .screen {
            display: none;
            animation: fadeIn 0.6s ease-out;
        }
        .screen.active {
            display: block;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .btn-primary {
            @apply bg-gradient-to-r from-purple-600 to-indigo-700 text-white font-bold py-4 px-8 rounded-xl shadow-lg hover:from-purple-700 hover:to-indigo-800 transition-all duration-300 transform hover:scale-105;
        }
        .btn-secondary {
            @apply bg-gray-300 text-gray-800 font-bold py-4 px-8 rounded-xl shadow-md hover:bg-gray-400 transition-all duration-300 transform hover:scale-105;
        }
        .btn-danger {
            @apply bg-red-600 text-white font-bold py-3 px-6 rounded-xl shadow-md hover:bg-red-700 transition-all duration-300;
        }
        .input-field {
            @apply w-full p-3 border border-gray-400 rounded-xl bg-white text-gray-800 focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200;
        }
        .label-text {
            @apply block text-left text-gray-700 font-semibold mb-2;
        }
        .checkbox-container {
            @apply flex items-center justify-between p-4 bg-gray-100 rounded-xl shadow-sm mb-3 cursor-pointer hover:bg-gray-200 transition-colors duration-200;
        }
        .checkbox-container input[type="checkbox"] {
            @apply h-6 w-6 text-purple-500 rounded-md border-gray-400 focus:ring-purple-500;
        }
        .pachinko-reel-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 180px;
            overflow: hidden;
            border: 5px solid #fcd34d;
            border-radius: 20px;
            background-color: #000;
            margin-top: 30px;
            position: relative;
            box-shadow: 0 0 20px rgba(252, 211, 77, 0.6);
        }
        .pachinko-reel {
            font-size: 100px;
            font-weight: bold;
            color: #fcd34d;
            line-height: 1;
            animation: spinReel 1s ease-out forwards;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: opacity 0.3s ease-in-out;
            text-shadow: 0 0 10px rgba(252, 211, 77, 0.8);
        }
        .pachinko-reel.active {
            opacity: 1;
        }
        @keyframes spinReel {
            0% { transform: translate(-50%, -50%) translateY(-150px) rotateX(90deg); opacity: 0; }
            50% { opacity: 1; }
            100% { transform: translate(-50%, -50%) translateY(0) rotateX(0deg); opacity: 1; }
        }
        .pachinko-reel-final {
            font-size: 120px;
            font-weight: bold;
            color: #fcd34d;
            animation: finalReveal 0.8s ease-out forwards;
            text-shadow: 0 0 20px rgba(252, 211, 77, 1);
        }
        @keyframes finalReveal {
            0% { transform: scale(0.5); opacity: 0; }
            70% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }

        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.6);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-out;
        }
        .modal-overlay.active {
            opacity: 1;
            pointer-events: all;
        }
        .modal-content {
            background: linear-gradient(145deg, #ffffff, #f0f4f8);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 450px;
            width: 90%;
            transform: translateY(-20px);
            transition: transform 0.3s ease-out;
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }
        .text-gradient {
            background: linear-gradient(45deg, #a78bfa, #f472b6);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .icon {
            display: inline-block;
            width: 24px;
            height: 24px;
            vertical-align: middle;
            margin-right: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Confirmation Modal -->
        <div id="confirmationModal" class="modal-overlay">
            <div class="modal-content">
                <p id="modalMessage" class="text-xl font-semibold mb-6 text-gray-800"></p>
                <div class="flex justify-around gap-4">
                    <button id="modalConfirmBtn" class="btn-primary flex-1">ã¯ã„</button>
                    <button id="modalCancelBtn" class="btn-secondary flex-1">ã„ã„ãˆ</button>
                </div>
            </div>
        </div>

        <!-- 1. è¨­å®šç”»é¢ -->
        <div id="settingsScreen" class="screen active">
            <h2 id="settingsScreenTitle" class="text-3xl font-bold mb-8 text-gradient"></h2>

            <div class="mb-6">
                <label for="customAppNameInput" class="label-text">ãƒãƒƒãƒãƒ³ã‚°ãƒ†ãƒ¼ãƒ</label>
                <input type="text" id="customAppNameInput" placeholder="ä¾‹: å‹æƒ…ãƒãƒƒãƒãƒ³ã‚°" class="input-field">
            </div>

            <div class="mb-6">
                <label for="maxCrushes" class="label-text">é¸æŠå¯èƒ½äººæ•°</label>
                <select id="maxCrushes" class="input-field">
                    <option value="1">1äºº</option>
                    <option value="2">2äºº</option>
                    <option value="3">3äºº</option>
                    <option value="4">4äºº</option>
                    <option value="5">5äºº</option>
                </select>
            </div>

            <div class="mb-6">
                <label class="label-text flex items-center justify-between">
                    <span>ã‚ãªãŸã«ä¸€æ–¹çš„ã«ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººã‚’è¡¨ç¤ºã™ã‚‹</span>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="showUnrequitedCrushesToggle" class="sr-only peer">
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:border-gray-300 after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
                    </label>
                </label>
            </div>

            <div class="mb-8">
                <label class="label-text flex items-center justify-between">
                    <span>ãƒŸãƒ¥ãƒ¼ãƒˆ</span>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" id="muteToggle" class="sr-only peer">
                        <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border after:border-gray-300 after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-purple-600"></div>
                    </label>
                </label>
            </div>

            <button id="goToParticipantsBtn" class="btn-primary w-full">å‚åŠ è€…åå…¥åŠ›ã¸</button>
        </div>

        <!-- 2. å‚åŠ è€…ç™»éŒ²ç”»é¢ -->
        <div id="participantsScreen" class="screen">
            <h2 class="text-3xl font-bold mb-8 text-gradient">å‚åŠ è€…åå…¥åŠ›</h2>

            <div id="participantInputs" class="mb-6 space-y-4">
                <!-- Participant input fields will be added here by JS -->
            </div>

            <div class="flex justify-between mb-8 gap-4">
                <button id="addParticipantBtn" class="btn-secondary flex-1">
                    <svg class="icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd"></path></svg>
                    <span>å‚åŠ è€…è¿½åŠ </span>
                </button>
                <button id="removeParticipantBtn" class="btn-danger flex-1">
                    <svg class="icon" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 011-1h4a1 1 0 110 2H8a1 1 0 01-1-1z" clip-rule="evenodd"></path></svg>
                    <span>å‚åŠ è€…å‰Šé™¤</span>
                </button>
            </div>

            <button id="startCrushSelectionBtn" class="btn-primary w-full">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
        </div>

        <!-- 3. ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººé¸æŠãƒ¢ãƒ¼ãƒ‰ (1äººãšã¤) -->
        <div id="crushSelectionScreen" class="screen">
            <h2 id="crushSelectionTitle" class="text-3xl font-bold mb-6 text-gradient"></h2>
            <p class="text-lg mb-8 text-gray-700">ã“ã®ç”»é¢ã‚’<span class="font-bold text-purple-600" id="currentParticipantNameTitle"></span>ã•ã‚“ã«è¦‹ã›ã¦ãã ã•ã„</p>

            <button id="iAmParticipantBtn" class="btn-primary w-full mb-8"><span class="font-bold text-purple-600" id="iAmParticipantName"></span>ã•ã‚“ã§ã‚ã‚Œã°ã“ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„</button>

            <div id="crushSelectionContent" class="hidden">
                <p class="text-lg mb-4 text-gray-700">ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººã‚’é¸ã‚“ã§ãã ã•ã„ (æœ€å¤§ <span class="font-bold text-purple-600" id="maxCrushCountDisplay"></span>äºº)</p>
                <div class="flex items-center mb-6">
                    <input type="checkbox" id="noCrushCheckbox" class="h-6 w-6 text-purple-500 rounded-md border-gray-400 focus:ring-purple-500 mr-2">
                    <label for="noCrushCheckbox" class="text-lg font-semibold text-gray-700">ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººã¯ã„ãªã„</label>
                </div>

                <div id="crushList" class="space-y-3 mb-8 text-left">
                    <!-- Crush list will be populated here by JS -->
                </div>

                <button id="finishSelectionBtn" class="btn-primary w-full">é¸æŠã—çµ‚ã‚ã‚Šã¾ã—ãŸ</button>
            </div>
        </div>

        <!-- 4. ãƒãƒƒãƒãƒ³ã‚°æˆç«‹çµ„æ•°ç™ºè¡¨ (å…±é€šæ¼”å‡ºç”»é¢) -->
        <div id="matchCountScreen" class="screen">
            <h2 id="matchCountTitle" class="text-3xl font-bold mb-8 text-gradient">ãƒãƒƒãƒãƒ³ã‚°æˆç«‹çµ„æ•°ç™ºè¡¨ï¼</h2>
            <p class="text-lg mb-4 text-gray-700">ãƒ‰ã‚­ãƒ‰ã‚­ã®çµæœç™ºè¡¨ï¼</p>

            <div class="pachinko-reel-container mb-8">
                <div id="pachinkoReel" class="pachinko-reel"></div>
            </div>

            <p id="matchCountMessage" class="text-2xl font-bold text-gray-800 mb-8"></p>

            <button id="goToResultBtn" class="btn-primary w-full">çµæœç™ºè¡¨ã¸</button>
        </div>

        <!-- 5. çµæœç™ºè¡¨ãƒ¢ãƒ¼ãƒ‰ (1äººãšã¤) -->
        <div id="resultScreen" class="screen">
            <h2 id="resultTitle" class="text-3xl font-bold mb-6 text-gradient">çµæœç™ºè¡¨</h2>
            <p class="text-lg mb-8 text-gray-700">ã“ã®ç”»é¢ã‚’<span class="font-bold text-purple-600" id="currentParticipantResultName"></span>ã•ã‚“ã«è¦‹ã›ã¦ãã ã•ã„</p>

            <button id="iAmParticipantResultBtn" class="btn-primary w-full mb-8"><span class="font-bold text-purple-600" id="iAmParticipantResultName"></span>ã•ã‚“ã§ã‚ã‚Œã°ã“ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„</button>

            <div id="resultContent" class="hidden">
                <button id="confirmResultBtn" class="btn-primary w-full mb-8">ç¢ºèªã™ã‚‹</button>
                <div id="matchResultDisplay" class="text-2xl font-bold text-green-600 mb-4">
                    <!-- Match result will be displayed here -->
                </div>
                <!-- æ–°æ©Ÿèƒ½: ä¸€æ–¹çš„ã«ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººæ•°è¡¨ç¤º -->
                <div id="unrequitedCrushDisplay" class="text-xl font-bold text-gray-700 mb-8 hidden">
                    <!-- Unrequited crush count will be displayed here -->
                </div>
                <p id="noMatchMessage" class="text-lg text-gray-700 mb-8 hidden">ãƒãƒƒãƒãƒ³ã‚°ã—ãŸäººã¯ã„ã¾ã›ã‚“ã§ã—ãŸã€‚</p>
                <button id="nextResultBtn" class="btn-primary w-full hidden">æ¬¡ã®äººã¸</button>
            </div>
        </div>

        <!-- Reset Button (always visible for debug/reset) -->
        <button id="resetAppBtn" class="btn-secondary mt-8 w-full">ã‚¢ãƒ—ãƒªã‚’ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <audio id="pingSound" src="https://assets.mixkit.co/sfx/preview/mixkit-positive-interface-click-1113.mp3" preload="auto"></audio>
    <audio id="matchSound" src="https://assets.mixkit.co/sfx/preview/mixkit-game-success-alert-2060.mp3" preload="auto"></audio>
    <audio id="pachinkoSpinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-coin-2155.mp3" preload="auto"></audio>
    <audio id="pachinkoStopSound" src="https://assets.mixkit.co/sfx/preview/mixkit-bonus-earned-in-video-game-2058.mp3" preload="auto"></audio>


    <script>
        // DOMè¦ç´ ã®å–å¾—
        const settingsScreen = document.getElementById('settingsScreen');
        const participantsScreen = document.getElementById('participantsScreen');
        const crushSelectionScreen = document.getElementById('crushSelectionScreen');
        const matchCountScreen = document.getElementById('matchCountScreen');
        const resultScreen = document.getElementById('resultScreen');

        const goToParticipantsBtn = document.getElementById('goToParticipantsBtn');
        const addParticipantBtn = document.getElementById('addParticipantBtn');
        const removeParticipantBtn = document.getElementById('removeParticipantBtn');
        const startCrushSelectionBtn = document.getElementById('startCrushSelectionBtn');
        const iAmParticipantBtn = document.getElementById('iAmParticipantBtn');
        const finishSelectionBtn = document.getElementById('finishSelectionBtn');
        const goToResultBtn = document.getElementById('goToResultBtn');
        const iAmParticipantResultBtn = document.getElementById('iAmParticipantResultBtn');
        const confirmResultBtn = document.getElementById('confirmResultBtn');
        const nextResultBtn = document.getElementById('nextResultBtn');
        const resetAppBtn = document.getElementById('resetAppBtn');

        const settingsScreenTitle = document.getElementById('settingsScreenTitle'); // æ–°ã—ã„ã‚¿ã‚¤ãƒˆãƒ«è¦ç´ 
        const customAppNameInput = document.getElementById('customAppNameInput'); // ã‚¢ãƒ—ãƒªåå…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰

        const maxCrushesSelect = document.getElementById('maxCrushes');
        const muteToggle = document.getElementById('muteToggle');
        const showUnrequitedCrushesToggle = document.getElementById('showUnrequitedCrushesToggle');

        const participantInputsDiv = document.getElementById('participantInputs');
        const crushSelectionTitle = document.getElementById('crushSelectionTitle');
        const currentParticipantNameTitle = document.getElementById('currentParticipantNameTitle');
        const iAmParticipantNameSpan = document.getElementById('iAmParticipantName');
        const crushSelectionContent = document.getElementById('crushSelectionContent');
        const maxCrushCountDisplay = document.getElementById('maxCrushCountDisplay');
        const noCrushCheckbox = document.getElementById('noCrushCheckbox');
        const crushListDiv = document.getElementById('crushList');
        const pachinkoReel = document.getElementById('pachinkoReel');
        const matchCountMessage = document.getElementById('matchCountMessage');
        const resultTitle = document.getElementById('resultTitle');
        const currentParticipantResultName = document.getElementById('currentParticipantResultName');
        const resultContent = document.getElementById('resultContent');
        const matchResultDisplay = document.getElementById('matchResultDisplay');
        const noMatchMessage = document.getElementById('noMatchMessage');
        const unrequitedCrushDisplay = document.getElementById('unrequitedCrushDisplay');

        const confirmationModal = document.getElementById('confirmationModal');
        const modalMessage = document.getElementById('modalMessage');
        const modalConfirmBtn = document.getElementById('modalConfirmBtn');
        const modalCancelBtn = document.getElementById('modalCancelBtn');

        const pingSound = document.getElementById('pingSound');
        const matchSound = document.getElementById('matchSound');
        const pachinkoSpinSound = document.getElementById('pachinkoSpinSound');
        const pachinkoStopSound = document.getElementById('pachinkoStopSound');

        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
        let appState = {
            settings: {
                appName: '', // ã‚«ã‚¹ã‚¿ãƒ ã‚¢ãƒ—ãƒªå
                maxCrushes: 1,
                muted: false,
                showUnrequitedCrushes: false,
                language: 'ja', // æ—¥æœ¬èªã®ã¿ã«å›ºå®š
            },
            participants: [], // { id: string, name: string, crushes: string[] }
            matches: [], // { p1Id: string, p2Id: string }
            currentParticipantIndex: 0,
            currentResultIndex: 0,
            totalMatchesFound: 0,
        };

        // ãƒ†ã‚­ã‚¹ãƒˆãƒ‡ãƒ¼ã‚¿ (æ—¥æœ¬èªã®ã¿)
        const texts = {
            defaultAppName: "ç‰‡æƒ³ã„ãƒãƒƒãƒãƒ³ã‚°", // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚¢ãƒ—ãƒªå
            // ä¿®æ­£: ã€Œãƒ‡ãƒ¼ãƒˆã«è¡Œã£ã¦ã¿ãŸã„äººæ•°ã€ã‹ã‚‰ã€Œé¸æŠå¯èƒ½äººæ•°ã€ã«å¤‰æ›´
            maxCrushesLabel: "é¸æŠå¯èƒ½äººæ•°",
            personCount: "{{count}}äºº",
            // æ±ç”¨çš„ãªè¡¨ç¾ã«çµ±ä¸€
            showUnrequitedCrushesLabel: "ã‚ãªãŸã«ä¸€æ–¹çš„ã«ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººã‚’è¡¨ç¤ºã™ã‚‹",
            muteLabel: "ãƒŸãƒ¥ãƒ¼ãƒˆ",
            goToParticipantsBtn: "å‚åŠ è€…åå…¥åŠ›ã¸",
            participantsTitle: "å‚åŠ è€…åå…¥åŠ›",
            addParticipantBtn: "å‚åŠ è€…è¿½åŠ ",
            addParticipantBtnText: "å‚åŠ è€…è¿½åŠ ",
            removeParticipantBtn: "å‚åŠ è€…å‰Šé™¤",
            removeParticipantBtnText: "å‚åŠ è€…å‰Šé™¤",
            startBtn: "ã‚¹ã‚¿ãƒ¼ãƒˆ",
            // ä¿®æ­£: ã€Œãƒ‡ãƒ¼ãƒˆã«è¡Œã£ã¦ã¿ãŸã„é¸æŠã€ã‹ã‚‰ã€Œãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººé¸æŠã€ã«å¤‰æ›´
            crushSelectionTitle: "ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººé¸æŠ", // ã“ã“ã¯å›ºå®šã§ã€Œãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººé¸æŠã€
            showScreenTo: "ã“ã®ç”»é¢ã‚’<span class='font-bold text-purple-600'>{{name}}</span>ã•ã‚“ã«è¦‹ã›ã¦ãã ã•ã„",
            iAmParticipantBtn: "<span class='font-bold text-purple-600'>{{name}}</span>ã•ã‚“ã§ã‚ã‚Œã°ã“ã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„",
            // ä¿®æ­£: ã€Œãƒ‡ãƒ¼ãƒˆã«è¡Œã£ã¦ã¿ãŸã„äººã‚’é¸ã‚“ã§ãã ã•ã„ã€ã‹ã‚‰ã€Œãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººã‚’é¸ã‚“ã§ãã ã•ã„ã€ã«å¤‰æ›´
            selectCrushes: "ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººã‚’é¸ã‚“ã§ãã ã•ã„ (æœ€å¤§ <span class='font-bold text-purple-600'>{{count}}</span>äºº)",
            // ä¿®æ­£: ã€Œãƒ‡ãƒ¼ãƒˆã«è¡Œã£ã¦ã¿ãŸã„äººã¯ã„ãªã„ã€ã‹ã‚‰ã€Œãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººã¯ã„ãªã„ã€ã«å¤‰æ›´
            noCrushCheckbox: "ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººã¯ã„ãªã„",
            finishSelectionBtn: "é¸æŠã—çµ‚ã‚ã‚Šã¾ã—ãŸ",
            // ã€Œä¸¡æ€ã„ã€ã‚’ã€Œãƒãƒƒãƒãƒ³ã‚°ã€ã«çµ±ä¸€
            matchCountTitle: "ãƒãƒƒãƒãƒ³ã‚°æˆç«‹çµ„æ•°ç™ºè¡¨ï¼",
            excitingResults: "ãƒ‰ã‚­ãƒ‰ã‚­ã®çµæœç™ºè¡¨ï¼",
            goToResultBtn: "çµæœç™ºè¡¨ã¸",
            resultTitle: "çµæœç™ºè¡¨",
            confirmResultBtn: "ç¢ºèªã™ã‚‹",
            // ã€Œä¸¡æ€ã„ã€ã‚’ã€Œãƒãƒƒãƒãƒ³ã‚°ã€ã«çµ±ä¸€
            noMutualCrush: "ãƒãƒƒãƒãƒ³ã‚°ã—ãŸäººã¯ã„ã¾ã›ã‚“ã§ã—ãŸã€‚",
            // æ±ç”¨çš„ãªè¡¨ç¾ã«çµ±ä¸€
            unrequitedCrushCount: "ã‚ãªãŸã«ä¸€æ–¹çš„ã«ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººãŒã‚ã¨ {{count}} äººã„ã¾ã™ã€‚",
            nextPersonBtn: "æ¬¡ã®äººã¸",
            resetAppBtn: "ã‚¢ãƒ—ãƒªã‚’ãƒªã‚»ãƒƒãƒˆ",
            modalConfirm: "ã“ã®å†…å®¹ã§ç¢ºå®šã—ã¾ã™ã‹ï¼Ÿ",
            modalReset: "ã‚¢ãƒ—ãƒªã®ãƒ‡ãƒ¼ã‚¿ã‚’å…¨ã¦ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ",
            modalMinParticipants: "å‚åŠ è€…ã¯æœ€ä½2äººå¿…è¦ã§ã™ã€‚",
            modalMaxParticipants: "å‚åŠ è€…ã¯æœ€å¤§10äººã¾ã§ã§ã™ã€‚",
            modalEmptyNames: "å…¨ã¦ã®å‚åŠ è€…ã®åå‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚",
            modalMaxCrushes: "é¸æŠã§ãã‚‹ã®ã¯æœ€å¤§{{count}}äººã¾ã§ã§ã™ã€‚",
            modalAllResultsDone: "å…¨å“¡ã®çµæœç™ºè¡¨ãŒçµ‚ã‚ã‚Šã¾ã—ãŸã€‚ã‚¢ãƒ—ãƒªã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ",
            yes: "ã¯ã„",
            no: "ã„ã„ãˆ",
            enterNamePlaceholder: "åå‰ã‚’å…¥åŠ›",
            // ã€Œä¸¡æ€ã„ã€ã‚’ã€Œãƒãƒƒãƒãƒ³ã‚°ã€ã«çµ±ä¸€
            youAndMutual: "ã‚ãªãŸã¨{{name}}ã•ã‚“ã€ãƒãƒƒãƒãƒ³ã‚°ã—ã¾ã—ãŸï¼ğŸ’–"
        };

        /**
         * ç”»é¢ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹é–¢æ•°
         * @param {HTMLElement} screenToShow - è¡¨ç¤ºã™ã‚‹ç”»é¢ã®DOMè¦ç´ 
         */
        function showScreen(screenToShow) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            screenToShow.classList.add('active');
            updateTextContent(); // ç”»é¢åˆ‡ã‚Šæ›¿ãˆæ™‚ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
        }

        /**
         * ãƒ¦ãƒ‹ãƒ¼ã‚¯IDã‚’ç”Ÿæˆã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼é–¢æ•°
         * @returns {string} ãƒ¦ãƒ‹ãƒ¼ã‚¯ID
         */
        function generateUniqueId() {
            return Math.random().toString(36).substring(2, 11);
        }

        /**
         * éŸ³ã‚’å†ç”Ÿã™ã‚‹é–¢æ•°
         * @param {HTMLAudioElement} sound - å†ç”Ÿã™ã‚‹Audioè¦ç´ 
         */
        function playSound(sound) {
            if (!appState.settings.muted) {
                sound.currentTime = 0;
                sound.play().catch(e => console.error("Failed to play sound:", e));
            }
        }

        /**
         * ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç¾åœ¨ã®è¨€èªè¨­å®šã«åŸºã¥ã„ã¦æ›´æ–°ã™ã‚‹
         */
        function updateTextContent() {
            // ã‚¢ãƒ—ãƒªã®ãƒ¡ã‚¤ãƒ³ã‚¿ã‚¤ãƒˆãƒ«ã‚’æ›´æ–°
            settingsScreenTitle.textContent = appState.settings.appName || texts.defaultAppName;

            // data-i18n-keyã‚’æŒã¤è¦ç´ ã‚’æ›´æ–°
            document.querySelectorAll('[data-i18n-key]').forEach(element => {
                const key = element.dataset.i18nKey;
                
                // å‹•çš„ãªå€¤ã‚’å«ã‚€è¦ç´ ã¯textContentã‚’ç›´æ¥æ›´æ–°ã—ãªã„
                // crushSelectionTitleã¯ã“ã“ã§æ›´æ–°ã›ãšã€startCrushSelectionForCurrentParticipantã§æ›´æ–°
                if (key === "showScreenTo" || key === "iAmParticipantBtn" || key === "selectCrushes" || key === "crushSelectionTitle") {
                    return;
                }
                
                if (element.tagName === 'INPUT' && element.placeholder) {
                    element.placeholder = texts[key];
                } else if (element.tagName === 'OPTION' && element.closest('select') && element.closest('select').id === 'maxCrushes') {
                    element.textContent = texts['personCount'].replace('{{count}}', element.value);
                } else if (element.tagName === 'BUTTON' && element.querySelector('span')) {
                    element.querySelector('span').textContent = texts[key];
                } else {
                    element.textContent = texts[key];
                }
            });

            // å‚åŠ è€…å…¥åŠ›ã®ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã‚’æ›´æ–°
            document.querySelectorAll('.participant-name-input').forEach(input => {
                input.placeholder = texts['enterNamePlaceholder'];
            });

            // ãƒ¢ãƒ¼ãƒ€ãƒ«ãƒœã‚¿ãƒ³ã®ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
            document.getElementById('modalConfirmBtn').textContent = texts['yes'];
            document.getElementById('modalCancelBtn').textContent = texts['no'];
        }


        /**
         * ç¢ºèªãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’è¡¨ç¤ºã™ã‚‹
         * @param {string} messageKey - ãƒ¢ãƒ¼ãƒ€ãƒ«ã«è¡¨ç¤ºã™ã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®ã‚­ãƒ¼
         * @param {object} args - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã«åŸ‹ã‚è¾¼ã‚€å¼•æ•°
         * @returns {Promise<boolean>} ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œã¯ã„ã€ã‚’æŠ¼ã—ãŸã‚‰trueã€ãã‚Œä»¥å¤–ã¯false
         */
        function showConfirmationModal(messageKey, args = {}) {
            return new Promise(resolve => {
                let message = texts[messageKey];
                for (const argKey in args) {
                    message = message.replace(new RegExp(`\\{\\{${argKey}\\}\\}`, 'g'), args[argKey]);
                }
                modalMessage.textContent = message;
                confirmationModal.classList.add('active');

                const handleConfirm = () => {
                    confirmationModal.classList.remove('active');
                    modalConfirmBtn.removeEventListener('click', handleConfirm);
                    modalCancelBtn.removeEventListener('click', handleCancel);
                    resolve(true);
                };

                const handleCancel = () => {
                    confirmationModal.classList.remove('active');
                    modalConfirmBtn.removeEventListener('click', handleConfirm);
                    modalCancelBtn.removeEventListener('click', handleCancel);
                    resolve(false);
                };

                modalConfirmBtn.addEventListener('click', handleConfirm);
                modalCancelBtn.addEventListener('click', handleCancel);
            });
        }

        // --- 1. è¨­å®šç”»é¢ã®ãƒ­ã‚¸ãƒƒã‚¯ ---
        // ã‚¢ãƒ—ãƒªåå…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        customAppNameInput.addEventListener('input', (e) => {
            appState.settings.appName = e.target.value;
            updateTextContent(); // ã‚¿ã‚¤ãƒˆãƒ«ã‚’å³æ™‚æ›´æ–°
        });

        maxCrushesSelect.addEventListener('change', (e) => {
            appState.settings.maxCrushes = parseInt(e.target.value);
            updateTextContent();
        });

        muteToggle.addEventListener('change', (e) => {
            appState.settings.muted = e.target.checked;
        });

        showUnrequitedCrushesToggle.addEventListener('change', (e) => {
            appState.settings.showUnrequitedCrushes = e.target.checked;
        });

        goToParticipantsBtn.addEventListener('click', () => {
            if (appState.participants.length === 0) {
                appState.participants.push({ id: generateUniqueId(), name: '', crushes: [] });
                appState.participants.push({ id: generateUniqueId(), name: '', crushes: [] });
            }
            renderParticipantInputs();
            showScreen(participantsScreen);
        });

        // --- 2. å‚åŠ è€…ç™»éŒ²ç”»é¢ã®ãƒ­ã‚¸ãƒƒã‚¯ ---
        /**
         * å‚åŠ è€…å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹
         */
        function renderParticipantInputs() {
            participantInputsDiv.innerHTML = '';
            appState.participants.forEach((participant, index) => {
                const div = document.createElement('div');
                div.className = 'flex items-center gap-2';
                div.innerHTML = `
                    <label class="label-text flex-shrink-0">${texts['participantsTitle'].replace('å‚åŠ è€…åå…¥åŠ›', '')} ${index + 1}:</label>
                    <input type="text" value="${participant.name}" data-id="${participant.id}" placeholder="${texts['enterNamePlaceholder']}" class="input-field participant-name-input flex-grow">
                `;
                participantInputsDiv.appendChild(div);
            });

            document.querySelectorAll('.participant-name-input').forEach(input => {
                input.addEventListener('input', (e) => {
                    const id = e.target.dataset.id;
                    const participant = appState.participants.find(p => p.id === id);
                    if (participant) {
                        participant.name = e.target.value;
                    }
                });
            });
        }

        addParticipantBtn.addEventListener('click', () => {
            if (appState.participants.length >= 10) {
                showConfirmationModal('modalMaxParticipants');
                return;
            }
            appState.participants.push({ id: generateUniqueId(), name: '', crushes: [] });
            renderParticipantInputs();
        });

        removeParticipantBtn.addEventListener('click', async () => {
            if (appState.participants.length <= 2) {
                await showConfirmationModal('modalMinParticipants');
                return;
            }
            const confirmed = await showConfirmationModal('modalConfirm');
            if (confirmed) {
                appState.participants.pop();
                renderParticipantInputs();
            }
        });

        startCrushSelectionBtn.addEventListener('click', async () => {
            const emptyNames = appState.participants.filter(p => p.name.trim() === '');
            if (emptyNames.length > 0) {
                await showConfirmationModal('modalEmptyNames');
                return;
            }
            if (appState.participants.length < 2) {
                await showConfirmationModal('modalMinParticipants');
                return;
            }

            appState.participants.forEach(p => p.crushes = []);
            appState.currentParticipantIndex = 0;
            appState.matches = [];

            startCrushSelectionForCurrentParticipant();
            showScreen(crushSelectionScreen);
        });

        // --- 3. ãƒãƒƒãƒãƒ³ã‚°ã—ãŸã„äººé¸æŠãƒ¢ãƒ¼ãƒ‰ (1äººãšã¤) ---
        /**
         * ç¾åœ¨ã®å‚åŠ è€…ã®é¸æŠç”»é¢ã‚’è¨­å®šã™ã‚‹
         */
        function startCrushSelectionForCurrentParticipant() {
            const currentParticipant = appState.participants[appState.currentParticipantIndex];

            if (!currentParticipant) {
                calculateMatches();
                showScreen(matchCountScreen);
                startPachinkoAnimation();
                return;
            }

            playSound(pingSound);
            // ä¿®æ­£: ã‚¢ãƒ—ãƒªã®ãƒ†ãƒ¼ãƒåã‚’è¡¨ç¤º
            crushSelectionTitle.textContent = appState.settings.appName || texts.defaultAppName;
            
            // å‹•çš„ãªãƒ†ã‚­ã‚¹ãƒˆã‚’ç›´æ¥è¨­å®š
            document.querySelector('#crushSelectionScreen p').innerHTML = texts['showScreenTo'].replace('{{name}}', currentParticipant.name);
            document.querySelector('#iAmParticipantBtn').innerHTML = texts['iAmParticipantBtn'].replace('{{name}}', currentParticipant.name);
            document.querySelector('#crushSelectionContent p').innerHTML = texts['selectCrushes'].replace('{{count}}', appState.settings.maxCrushes);

            crushSelectionContent.classList.add('hidden');
            iAmParticipantBtn.classList.remove('hidden');

            renderCrushList(currentParticipant.id);
            noCrushCheckbox.checked = false;
            noCrushCheckbox.disabled = false;
        }

        iAmParticipantBtn.addEventListener('click', () => {
            iAmParticipantBtn.classList.add('hidden');
            crushSelectionContent.classList.remove('hidden');
        });

        noCrushCheckbox.addEventListener('change', (e) => {
            const checkboxes = document.querySelectorAll('#crushList input[type="checkbox"]');
            checkboxes.forEach(cb => {
                cb.checked = false;
                cb.disabled = e.target.checked;
            });
        });

        /**
         * é¸æŠãƒªã‚¹ãƒˆã‚’ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹
         * @param {string} currentParticipantId - ç¾åœ¨ã®å‚åŠ è€…ã®ID
         */
        function renderCrushList(currentParticipantId) {
            crushListDiv.innerHTML = '';
            appState.participants.forEach(p => {
                if (p.id === currentParticipantId) return;

                const label = document.createElement('label');
                label.className = 'checkbox-container';
                label.innerHTML = `
                    <span class="text-lg font-medium text-gray-700">${p.name}</span>
                    <input type="checkbox" data-id="${p.id}" class="crush-checkbox">
                `;
                crushListDiv.appendChild(label);
            });

            document.querySelectorAll('.crush-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', (e) => {
                    const checkedCount = document.querySelectorAll('.crush-checkbox:checked').length;
                    if (checkedCount > appState.settings.maxCrushes) {
                        e.target.checked = false;
                        showConfirmationModal('modalMaxCrushes', { count: appState.settings.maxCrushes });
                    } else {
                        noCrushCheckbox.checked = false;
                        noCrushCheckbox.disabled = (checkedCount > 0);
                    }
                });
            });
        }

        finishSelectionBtn.addEventListener('click', async () => {
            const currentParticipant = appState.participants[appState.currentParticipantIndex];
            if (!currentParticipant) return;

            currentParticipant.crushes = [];
            if (!noCrushCheckbox.checked) {
                document.querySelectorAll('.crush-checkbox:checked').forEach(checkbox => {
                    currentParticipant.crushes.push(checkbox.dataset.id);
                });
            }

            const confirmed = await showConfirmationModal('modalConfirm');
            if (confirmed) {
                appState.currentParticipantIndex++;
                startCrushSelectionForCurrentParticipant();
            }
        });

        // --- ãƒãƒƒãƒãƒ³ã‚°è¨ˆç®—ãƒ­ã‚¸ãƒƒã‚¯ ---
        function calculateMatches() {
            appState.matches = [];
            const participantsMap = new Map(appState.participants.map(p => [p.id, p]));

            for (let i = 0; i < appState.participants.length; i++) {
                const p1 = appState.participants[i];
                for (const crushId of p1.crushes) {
                    const p2 = participantsMap.get(crushId);
                    if (p2 && p2.crushes.includes(p1.id)) {
                        const sortedMatchIds = [p1.id, p2.id].sort();
                        const newMatch = { p1Id: sortedMatchIds[0], p2Id: sortedMatchIds[1] };

                        const isDuplicate = appState.matches.some(m =>
                            m.p1Id === newMatch.p1Id && m.p2Id === newMatch.p2Id
                        );
                        if (!isDuplicate) {
                            appState.matches.push(newMatch);
                        }
                    }
                }
            }
            appState.totalMatchesFound = appState.matches.length;
        }

        // --- 4. ãƒãƒƒãƒãƒ³ã‚°æˆç«‹çµ„æ•°ç™ºè¡¨ (å…±é€šæ¼”å‡ºç”»é¢) ---
        function startPachinkoAnimation() {
            playSound(pachinkoSpinSound);
            pachinkoReel.textContent = '';
            pachinkoReel.classList.remove('pachinko-reel-final');
            pachinkoReel.classList.add('active');

            let count = 0;
            const interval = setInterval(() => {
                pachinkoReel.textContent = Math.floor(Math.random() * 10).toString();
                count++;
                if (count > 30) {
                    clearInterval(interval);
                    stopPachinkoAnimation();
                }
            }, 80);
        }

        function stopPachinkoAnimation() {
            playSound(pachinkoStopSound);
            pachinkoReel.classList.remove('active');
            setTimeout(() => {
                pachinkoReel.textContent = appState.totalMatchesFound.toString();
                pachinkoReel.classList.add('pachinko-reel-final');
                
                if (appState.totalMatchesFound > 0) {
                    matchCountMessage.textContent = texts['matchCountTitle'].replace('ï¼', '') + `ï¼${appState.totalMatchesFound}çµ„ã®ãƒãƒƒãƒãƒ³ã‚°ãŒæˆç«‹ã—ã¾ã—ãŸï¼`;
                } else {
                    matchCountMessage.textContent = texts['noMutualCrush'];
                }
            }, 300);
        }

        goToResultBtn.addEventListener('click', () => {
            appState.currentResultIndex = 0;
            startResultAnnouncementForCurrentParticipant();
            showScreen(resultScreen);
        });

        // --- 5. çµæœç™ºè¡¨ãƒ¢ãƒ¼ãƒ‰ (1äººãšã¤) ---
        /**
         * ç¾åœ¨ã®å‚åŠ è€…ã®çµæœç™ºè¡¨ç”»é¢ã‚’è¨­å®šã™ã‚‹
         */
        function startResultAnnouncementForCurrentParticipant() {
            const currentParticipant = appState.participants[appState.currentResultIndex];

            if (!currentParticipant) {
                showConfirmationModal('modalAllResultsDone').then(confirmed => {
                    if (confirmed) {
                        resetApp();
                    } else {
                        showScreen(settingsScreen);
                    }
                });
                return;
            }

            playSound(pingSound);
            resultTitle.textContent = texts['resultTitle'];
            
            // å‹•çš„ãªãƒ†ã‚­ã‚¹ãƒˆã‚’ç›´æ¥è¨­å®š
            document.querySelector('#resultScreen p').innerHTML = texts['showScreenTo'].replace('{{name}}', currentParticipant.name);
            document.querySelector('#iAmParticipantResultBtn').innerHTML = texts['iAmParticipantBtn'].replace('{{name}}', currentParticipant.name);


            resultContent.classList.add('hidden');
            iAmParticipantResultBtn.classList.remove('hidden');

            confirmResultBtn.classList.remove('hidden');

            matchResultDisplay.textContent = '';
            noMatchMessage.classList.add('hidden');
            unrequitedCrushDisplay.classList.add('hidden');
            nextResultBtn.classList.add('hidden');
        }

        iAmParticipantResultBtn.addEventListener('click', () => {
            iAmParticipantResultBtn.classList.add('hidden');
            resultContent.classList.remove('hidden');
        });

        confirmResultBtn.addEventListener('click', () => {
            const currentParticipant = appState.participants[appState.currentResultIndex];
            if (!currentParticipant) return;

            let foundMatch = false;
            for (const match of appState.matches) {
                if (match.p1Id === currentParticipant.id) {
                    const matchedParticipant = appState.participants.find(p => p.id === match.p2Id);
                    if (matchedParticipant) {
                        matchResultDisplay.textContent = texts['youAndMutual'].replace('{{name}}', matchedParticipant.name);
                        playSound(matchSound);
                        foundMatch = true;
                        break;
                    }
                } else if (match.p2Id === currentParticipant.id) {
                    const matchedParticipant = appState.participants.find(p => p.id === match.p1Id);
                    if (matchedParticipant) {
                        matchResultDisplay.textContent = texts['youAndMutual'].replace('{{name}}', matchedParticipant.name);
                        playSound(matchSound);
                        foundMatch = true;
                        break;
                    }
                }
            }

            if (!foundMatch) {
                matchResultDisplay.textContent = '';
                noMatchMessage.classList.remove('hidden');
            }

            if (appState.settings.showUnrequitedCrushes) {
                let unrequitedCrushCount = 0;
                for (const otherParticipant of appState.participants) {
                    if (otherParticipant.id === currentParticipant.id) continue;

                    if (otherParticipant.crushes.includes(currentParticipant.id)) {
                        const isMutual = appState.matches.some(match =>
                            (match.p1Id === currentParticipant.id && match.p2Id === otherParticipant.id) ||
                            (match.p1Id === otherParticipant.id && match.p2Id === currentParticipant.id)
                        );
                        if (!isMutual) {
                            unrequitedCrushCount++;
                        }
                    }
                }

                if (unrequitedCrushCount > 0) {
                    unrequitedCrushDisplay.textContent = texts['unrequitedCrushCount'].replace('{{count}}', unrequitedCrushCount);
                    unrequitedCrushDisplay.classList.remove('hidden');
                } else {
                    unrequitedCrushDisplay.classList.add('hidden');
                }
            } else {
                unrequitedCrushDisplay.classList.add('hidden');
            }

            confirmResultBtn.classList.add('hidden');
            nextResultBtn.classList.remove('hidden');
        });

        nextResultBtn.addEventListener('click', async () => {
            const confirmed = await showConfirmationModal('modalConfirm');
            if (confirmed) {
                appState.currentResultIndex++;
                startResultAnnouncementForCurrentParticipant();
            }
        });

        // --- ã‚¢ãƒ—ãƒªã®ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ ---
        function resetApp() {
            appState = {
                settings: {
                    appName: '', // ã‚¢ãƒ—ãƒªåã‚’ãƒªã‚»ãƒƒãƒˆ
                    maxCrushes: 1,
                    muted: false,
                    showUnrequitedCrushes: false,
                    language: 'ja',
                },
                participants: [],
                matches: [],
                currentParticipantIndex: 0,
                currentResultIndex: 0,
                totalMatchesFound: 0,
            };
            customAppNameInput.value = ''; // å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚‚ã‚¯ãƒªã‚¢
            maxCrushesSelect.value = 1;
            muteToggle.checked = false;
            showUnrequitedCrushesToggle.checked = false;
            participantInputsDiv.innerHTML = '';
            showScreen(settingsScreen);
        }

        resetAppBtn.addEventListener('click', async () => {
            const confirmed = await showConfirmationModal('modalReset');
            if (confirmed) {
                resetApp();
            }
        });

        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹•æ™‚ã®åˆæœŸåŒ–
        window.onload = () => {
            resetApp(); // åˆæœŸçŠ¶æ…‹ã§ãƒªã‚»ãƒƒãƒˆ
            // customAppNameInputã®placeholderã‚’åˆæœŸè¨­å®š
            customAppNameInput.placeholder = texts.defaultAppName;
            updateTextContent(); // åˆæœŸè¡¨ç¤ºæ™‚ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
        };
    </script>
</body>
</html>
